# -------------------------------------------------------
# ANN with Backpropagation
# Handwritten Digit Recognition (MNIST)
# -------------------------------------------------------

import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Flatten
from tensorflow.keras.utils import to_categorical
import matplotlib.pyplot as plt

# -------------------------------------------------------
# Step 1: Load MNIST Dataset
# -------------------------------------------------------

(x_train, y_train), (x_test, y_test) = tf.keras.datasets.mnist.load_data()

# -------------------------------------------------------
# Step 2: Normalize Data (0–255 → 0–1)
# -------------------------------------------------------

x_train = x_train / 255.0
x_test = x_test / 255.0

# -------------------------------------------------------
# Step 3: Convert Output Labels to One-Hot Encoding
# -------------------------------------------------------

y_train = to_categorical(y_train, 10)
y_test = to_categorical(y_test, 10)

# -------------------------------------------------------
# Step 4: Build ANN Model
# -------------------------------------------------------

model = Sequential()

# Input layer (Flatten 28x28 → 784)
model.add(Flatten(input_shape=(28, 28)))

# Hidden layer (128 neurons)
model.add(Dense(128, activation='relu'))

# Output layer (10 neurons for digits 0–9)
model.add(Dense(10, activation='softmax'))

# -------------------------------------------------------
# Step 5: Compile Model
# -------------------------------------------------------

model.compile(
    optimizer='adam',              # Backpropagation + Adam optimizer
    loss='categorical_crossentropy',
    metrics=['accuracy']
)

# -------------------------------------------------------
# Step 6: Train Model
# -------------------------------------------------------

model.fit(x_train, y_train, epochs=5, batch_size=32)

# -------------------------------------------------------
# Step 7: Evaluate Model
# -------------------------------------------------------

test_loss, test_accuracy = model.evaluate(x_test, y_test)

print("\nTest Accuracy:", round(test_accuracy * 100, 2), "%")

# -------------------------------------------------------
# Step 8: Predict Example
# -------------------------------------------------------

predictions = model.predict(x_test)

# Show first test image
plt.imshow(x_test[0], cmap='gray')
plt.title("Predicted Digit: " + str(predictions[0].argmax()))
plt.show()

OUTPUT:
Test Accuracy: 97.7 %
313/313 ━━━━━━━━━━━━━━━━━━━━ 1s 1ms/step
